<!DOCTYPE html>
<html lang="en">
<head>

  <title></title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.2/css/uikit.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.2/js/uikit.min.js"></script>

  <link rel="icon" href="/wp-content/uploads/2019/04/cropped-ms-icon-310x310-32x32.png" sizes="32x32">

  <link rel="apple-touch-icon" sizes="57x57" href="logo/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="logo/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="logo/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="logo/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="logo/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="logo/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="logo/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="logo/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="logo/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="logo/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="logo/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="logo/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="logo/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="logo/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- <link rel="stylesheet" href="./css/style.css" /> -->
  <link rel="stylesheet" href="./css/notyf.min.css" />
  <link rel="stylesheet" type="text/css" href="./css/dashboard.css?v=1.0">
  <script src="./js/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
  <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-app.js"></script>

  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-firestore.js"></script>
  <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
  <script type="text/javascript" src="./js/firebase_init.js"></script>
  <script src="https://js.stripe.com/v1/"></script>
  <script src="./js/uikit-icons.min.js" ></script>
  <!--Start of Tawk.to Script-->
  <script type="text/javascript">
    var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
    (function(){
      var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
      s1.async=true;
      s1.src='https://embed.tawk.to/5cd1f2bdd07d7e0c639267a6/default';
      s1.charset='UTF-8';
      s1.setAttribute('crossorigin','*');
      s0.parentNode.insertBefore(s1,s0);
    })();
  </script>
  <!--End of Tawk.to Script-->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-137827565-2');
</script>

  <style type="text/css">
    .reportCard{
      background-color: #f8f9fe;
    }
    article{
      /*-webkit-user-select: none;*/ /* Safari */        
      /*-moz-user-select: none;*/ /* Firefox */
      /*-ms-user-select: none;*/ /* IE10+/Edge */
      /*user-select: none;*/ /* Standard */
      color: #666 !important;

    }
    img.vert-move {
      -webkit-animation: mover 1s infinite  alternate;
      animation: mover 1s infinite  alternate;
    }
    img.vert-move {
      -webkit-animation: mover 1s infinite  alternate;
      animation: mover 1s infinite  alternate;
    }
    @-webkit-keyframes mover {
      0% { transform: translateY(0); }
      100% { transform: translateY(-10px); }
    }
    @keyframes mover {
      0% { transform: translateY(0); }
      100% { transform: translateY(-10px); }
    }
    #nav-top{

      float:right;

    }

    #sidebar{
      top:0px;
      max-width:15% !important;
    }
    .nav-shrink{
      margin-left: 15% !important;

    }
    .uk-button-primary{
      background-color:#4054be !important;
    }
    .horizontal-center{
      margin-top: 50vh;
    }
    .floating {  
      animation-name: floating;
      animation-duration: 3s;
      animation-iteration-count: infinite;
      animation-timing-function: ease-in-out;
      width:30px;
    }

    @keyframes floating {
      from { transform: translate(0,  0px); }
      65%  { transform: translate(0, 15px); }
      to   { transform: translate(0, -0px); }    
    }
    #my-id > .uk-modal-dialog{
      height:100vh;
      top: -10px;
      overflow: hidden;

    }
    .pre-load{
      height: 100%;
      width: 100%;
      z-index: 999999;
      position: absolute;
    }
    #proCard{
      margin-top: 30px;
      margin-bottom: 30px;
    }
  </style>
  <script type="text/javascript">
  </script>
  <script>
    const firestore = firebase.firestore();
    const settings = {/* your settings... */ timestampsInSnapshots: true};
    firestore.settings(settings);

    UIkit.util.ready(function(){
      var loadValue = 10;
      var animate = setInterval(function () {

        loadValue += 10;

        switch(true){
          case loadValue <= 30:
          jQuery('#loadingInfo').text('Loading Page Content...');
          break;
          case loadValue <= 50 && loadValue > 30:
          jQuery('#loadingInfo').text('Securing Connection...');
          break;
          case loadValue > 50 && loadValue <= 100:
          jQuery('#loadingInfo').text('Rendering Data...');
          break;
        }

        jQuery('#js-loading').val(loadValue);

        if (loadValue >= 100) {
          clearInterval(animate);
          $('main').removeClass('uk-hidden');
          $('.pre-load').addClass('uk-animation-slide-bottom uk-hidden');
          var confirmState = false;

        }

      }, 200);

    });

    var currentUser

    firebase.auth().onAuthStateChanged(function(user){
      if(user){
        currentUser = firebase.auth().currentUser;
        var bioFirebase
        currentUser.uid=1
        firebase.database().ref('user/'+ currentUser.uid + '/userMeta').once('value').then(function(snapshot){
          bioFirebase = snapshot.val().userBio || 'Update Bio Here';
        }).then(function(){
         $('.bio-upload').attr("placeholder", bioFirebase);
       });
        $('.profile-img').attr("src","" + currentUser.photoURL);
        $('.user-name').text(currentUser.displayName);
        $('.name-upload').attr("placeholder", currentUser.displayName);
        
      }else{
        window.location.href="/login";
      }
    });

</script>
</head>
<body>
  <div class="pre-load uk-inline uk-animation-reverse">
    <div class="uk-position-center uk-overlay">
      <img class="floating uk-align-center" style="width:100px;" src="./images/logo.png">
      <progress id="js-loading" class="uk-progress" value="10" max="100"></progress>
      <h4 class="uk-h4">Welcome to Terrifio&trade;!</h4>
      <p id="loadingInfo">Loading Please Wait...</p>
    </div>
  </div>
  <main class="uk-hidden">
    <!--HEADER-->
    <header id="top-head" class="uk-position-fixed">
      <div style="min-height:50px;" class="uk-container uk-container-expand uk-background-primary">
        <nav class="uk-navbar uk-light" data-uk-navbar="mode:click; duration: 250">
          <div class="uk-navbar-left">
            <div class="uk-navbar-item uk-hidden@m">
              <a class="uk-logo" href="/"><img class="custom-logo" src="./images/logo.png" alt=""></a> 
            </div>
            <ul class="uk-navbar-nav uk-visible@m">
              <li>
                <a href="#">Settings <span data-uk-icon="icon: triangle-down"></span></a>
                <div class="uk-navbar-dropdown">
                  <ul class="uk-nav uk-navbar-dropdown-nav">
                    <li class="uk-nav-header">Your Account</li>
                    <!-- <li><a href="#"><span data-uk-icon="icon: info"></span> Summary</a></li> -->
                    <li><a href="/account"><span data-uk-icon="icon: settings"></span> Settings</a></li>
                    <li class="uk-nav-divider"></li>
                    <li><a href="/user"><span data-uk-icon="icon: image"></span> Your Profile</a></li>
                    <li class="uk-nav-divider"></li>
                    <li><a onClick="firebase.auth().signOut();"><span data-uk-icon="icon: sign-out"></span> Logout</a></li>
                  </ul>
                </div>
              </li>
            </ul>
<!--             <div class="uk-navbar-item">
              <a href="/digitalipadvisor"><button  class="uk-button uk-button-default">
                New Project
              </button></a>
            </div> -->
            <div class="uk-navbar-item uk-visible@s">
              <!-- <form class="uk-search uk-search-default">
                <span data-uk-search-icon></span>
                <input class="uk-search-input search-field" type="search" placeholder="Search">
              </digitalipadvisor> -->
            </div>
          </div>
          <div class="uk-navbar-right">
            <ul class="uk-navbar-nav">
              <li class="uk-visible@m"><a href="/user" data-uk-icon="icon:user" title="Your profile" data-uk-tooltip></a></li>
              <li class="uk-visible@m"><a href="/account" data-uk-icon="icon: settings" title="Settings" data-uk-tooltip></a></li>
              <li class="uk-visible@m"><a onClick="logout();" data-uk-icon="icon:  sign-out" title="Sign Out" data-uk-tooltip></a></li>
              <li><a class="uk-navbar-toggle uk-hidden@m" uk-toggle="target: #left-col; cls: uk-visible@m" data-uk-navbar-toggle-icon title="Menu" data-uk-tooltip></a></li>
            </ul>
          </div>
        </nav>
      </div>
    </header>
    <!--/HEADER-->
    <!-- LEFT BAR -->
    <aside id="left-col" class="uk-light uk-visible@m">
      <div class="left-logo uk-align-center uk-flex uk-flex-middle">
        <a href="/"><img class="custom-logo" src="./images/logo.png" alt=""></a>
        <h4 class="uk-h4" style="padding-bottom: 15px;">Terrifio &trade;</h4>
      </div>
      <div class="left-content-box  content-box-dark">
        <a href="/user">
          <img src="" alt="" class="uk-border-circle profile-img">
        </a>
        
        <h4 class="uk-text-center uk-margin-remove-vertical text-light"></h4>
        
        <div class="uk-position-relative uk-text-center uk-display-block">
          <a href="#" class="uk-text-small uk-text-muted user-name uk-display-block uk-text-center" data-uk-icon="icon: triangle-down; ratio: 0.7">User</a>
          <!-- user dropdown -->
          <div class="uk-dropdown user-drop" data-uk-dropdown="mode: click; pos: bottom-center; animation: uk-animation-slide-bottom-small; duration: 150">
            <ul class="uk-nav uk-dropdown-nav uk-text-left">
              <li><a href="/account"><span data-uk-icon="icon: settings"></span> Settings</a></li>
              <li class="uk-nav-divider"></li>
              <li><a href="/user"><span data-uk-icon="icon: image"></span> Your Profile</a></li>
              <li class="uk-nav-divider"></li>
              <li><a onClick="firebase.auth().signOut();"><span data-uk-icon="icon: sign-out"></span> Logout</a></li>
            </ul>
          </div>
          <!-- /user dropdown -->
        </div>
      </div>
      
      <div class="left-nav-wrap">
        <ul class="uk-nav uk-nav-default uk-nav-parent-icon" data-uk-nav>
          <li class="uk-nav-header">ACTIONS</li>
          <li><a href="/"><span data-uk-icon="icon: thumbnails" class="uk-margin-small-right"></span>Dashboard</a></li>
          <li><a href="/calculator"><span data-uk-icon="icon: credit-card" class="uk-margin-small-right"></span>Cost Forecaster</a></li>
<!--           <li><a class="uk-disabled" title="Coming Soon" href="#"><span data-uk-icon="icon: calendar" class="uk-margin-small-right"></span>Calendar</a>
          </li> -->
<!--          
          <li><a href="#"><span data-uk-icon="icon: thumbnails" class="uk-margin-small-right"></span>Featured Content</a></li>
          <li><a href="#"><span data-uk-icon="icon: lifesaver" class="uk-margin-small-right"></span>Tips</a></li> -->
          <li class="uk-parent">
            <a href="#"><span data-uk-icon="icon: comments" class="uk-margin-small-right"></span>Info</a>
            <ul class="uk-nav-sub">
              <li><a href="/privacy">Privacy Policy</a></li>
              <li><a href="/terms">Terms & Conditions</a></li>
            </ul>
          </li>
        </ul>
        <div class="left-content-box uk-margin-top">
        </div>
        
      </div>
      <div class="bar-bottom">
        <ul class="uk-subnav uk-flex uk-flex-center uk-child-width-1-5" data-uk-grid>
          <li>
            <a href="/" class="uk-icon-link" data-uk-icon="icon: home" title="Home" data-uk-tooltip></a>
          </li>
          <li>
            <a href="/account" class="uk-icon-link" data-uk-icon="icon: settings" title="Settings" data-uk-tooltip></a>
          </li>
          <!-- <li>
            <a href="#" class="uk-icon-link" data-uk-icon="icon: social"  title="Social" data-uk-tooltip></a>
          </li> -->
          
          <li>
            <a onClick="firebase.auth().signOut();" class="uk-icon-link" data-uk-tooltip="Sign out" data-uk-icon="icon: sign-out"></a>
          </li>
        </ul>
      </div>
    </aside>
    <!-- /LEFT BAR -->
    <script type="text/javascript">
      function deleteReport(reportSuffix, reportPrefix, formName){
        var reportID = String(reportPrefix) + String(reportSuffix);
        console.log(reportPrefix)
        if(confirm('Are you sure you wish to delete '+ formName + '?') == true){
          var parent = database.ref('user/' + userID+'/'+reportID);
          parent.on('child_removed', function (snapshot) {
            console.log(snapshot);
          })
          parent.remove();
        } 
      }
    </script>
    <link href="./datedropper/datedropper.css" rel="stylesheet" type="text/css" />
    <script src="./datedropper/datedropper.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="./css/datepicker.css">
    <script src="https://unpkg.com/ionicons@4.5.0/dist/ionicons.js"></script>

    <!-- CONTENT -->
    <div id="content" class="uk-background-cover uk-overlay uk-overlay-cover uk-overlay-default " style="background-image: url('./images/background.jpg')" data-uk-height-viewport="expand: true">
      <div class="uk-container uk-container-expand">
        <hr>
        <div class="uk-grid uk-grid-medium" data-uk-grid>

          <!-- panel -->
          <div class="uk-width-3-3@l uk-align-center">
            <div class="uk-card uk-card-default uk-card-small uk-card-hover">
              <div class="uk-card-header">
                <div class="uk-grid uk-grid-small">
                  <div class="uk-width-auto"><h4>Profile</h4></div>
                  <div class="uk-width-expand uk-text-right panel-icons">
                    <!-- <a href="#" class="uk-icon-link" title="Move" data-uk-tooltip data-uk-icon="icon: move"></a>
                      <a href="#" class="uk-icon-link" title="Configuration" data-uk-tooltip data-uk-icon="icon: cog"></a> -->
                      <a href="#" class="uk-icon-link" title="Close" data-uk-tooltip data-uk-icon="icon: cross"></a>
                    </div>
                  </div>
                </div>
                <div class="uk-card-body">
                  <div class="uk-grid">
                    <div class="uk-width-1-3@s">
                      <img class="profile-img" src="">
                    </div>
                    
                    <div class="js-upload uk-placeholder uk-width-2-3@s uk-text-center">
                      <label>Profile Picture</label>
                      <span uk-icon="icon: cloud-upload"></span>
                      <span class="uk-text-middle">Drag new profile image here or</span>
                      <div uk-form-custom>
                        <input type="file" id="input" single>
                        <span class="uk-link">selecting one</span>
                      </div>
                      <progress id="js-progressbar" class="uk-progress" value="0" max="100" hidden></progress>
                    </div>

                    
                  </div>
                  <fieldset class="uk-fieldset">
                    <div class="uk-margin">
                      <label for="name">Full Name</label>
                      <input class="uk-input name-upload" type="text" name="name">
                    </div>

                    <div class="uk-margin">
                      <label for="bio">Biography</label>
                      <textarea class="uk-textarea bio-upload"></textarea>
                    </div>
                  </fieldset>
                  <button onClick="updateUser();" class="uk-button uk-button-default uk-align-right save-button">Save</button>

                </div>

              </div>
            </div>
            <!-- /panel -->
          </div>
        </div>
      </div>
      <div id="footer" class="uk-section uk-section-xsmall" style="background-color: rgba(0,0,0,0.15)">
        <div class="uk-container">
          <div class="uk-grid uk-child-width-1-2@s uk-text-center uk-grid-stack" data-uk-grid="">
            <div class="uk-text-small uk-text-muted uk-first-column uk-align-center">
              <a href="https://terrifio.co.uk">Copyright 2019 Terrifio &trade; All Rights Reserved.</a>
            </div>
          </div>
        </div>
      </div>
      <!-- Load More Javascript -->
      <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.0/Chart.min.js" integrity="sha256-UGwvyUFH6Qqn0PSyQVw4q3vIX0wV1miKTracNJzAWPc=" crossorigin="anonymous"></script> -->
      <script>

       function updateUser(){
        var name = $('.name-upload').val();
        var bio = $('.bio-upload').val();
        console.log("user-currentuser", currentUser);
        if(name){
          currentUser.updateProfile({
            displayName : name
          }).then(function(){

          }).catch(function(error){
            console.log(error);
          });
        }
        if(bio){
          console.log('Uploaded ', bio)
          firebase.database().ref('user/' + currentUser.uid + '/userMeta').update({
            userBio : bio
          });
        }
        $('.save-button').css('color', '#32d296');
        $('.save-button').css('border-color', '#32d296');


      }

      var bar = document.getElementById('js-progressbar');
      var storage = firebase.storage();
      var storageRef = storage.ref();

      UIkit.upload('.js-upload', {

        url: '',
        allow : '*.(jpg|jpeg|gif|png)',
        filelimit: 1,

        beforeSend: function () {
          console.log('beforeSend', arguments);
        },
        beforeAll: function () {
          console.log('beforeAll', arguments);
          console.log(arguments[1][0].type);
          var blob = new Blob(arguments[1], {type: arguments[1][0].type})
          console.log(blob)
          firebaseUpload(blob);
        },
        load: function () {
          console.log('load', arguments);
        },
        error: function () {
          console.log('error', arguments);
        },
        complete: function () {
          console.log('complete', arguments);
        },

        loadStart: function (e) {
          console.log('loadStart', arguments);

          bar.removeAttribute('hidden');
        },

        progress: function (e) {
          console.log('progress', arguments);


        },

        loadEnd: function (e) {
          console.log('loadEnd', arguments);


        },

        completeAll: function () {
          console.log('completeAll', arguments);
        }

      });
      function firebaseUpload(file){
        bar.removeAttribute('hidden');
        var fileExtension = file.type.split("/", 2);
        console.log("extension", fileExtension[1]);
        var uploadTask = storageRef.child('images/'+ currentUser.uid +fileExtension[1]).put(file);

          // Register three observers:
          // 1. 'state_changed' observer, called any time the state changes
          // 2. Error observer, called on failure
          // 3. Completion observer, called on successful completion
          uploadTask.on('state_changed', function(snapshot){
            // Observe state change events such as progress, pause, and resume
            // Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded
            var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
            bar.max = 100;
            bar.value = progress;
            console.log('Upload is ' + progress + '% done');
            switch (snapshot.state) {
              case firebase.storage.TaskState.PAUSED: // or 'paused'
              console.log('Upload is paused');
              break;
              case firebase.storage.TaskState.RUNNING: // or 'running'
              console.log('Upload is running');
              break;
            }
          }, function(error) {
            // Handle unsuccessful uploads
          }, function() {
            // Handle successful uploads on complete
            // For instance, get the download URL: https://firebasestorage.googleapis.com/...
            uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {
              console.log(downloadURL)
              currentUser.updateProfile({
                photoURL: downloadURL
              }).then(function(){

              }).catch(function(error){
                console.log(error);
              });
            });
          });
        }

      </script>
      <!-- OFFCANVAS -->
    <!-- <div id="offcanvas-nav" data-uk-offcanvas="flip: true; overlay: true">
      <div class="uk-offcanvas-bar uk-offcanvas-bar-animation uk-offcanvas-slide">
        <button class="uk-offcanvas-close uk-close uk-icon" type="button" data-uk-close></button>
        
      </div>
    </div> -->
    <!-- /OFFCANVAS -->
    
    <!-- JS FILES -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.2/js/uikit-icons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
    <!--    <script src="./js/chartScripts.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.transit/0.9.12/jquery.transit.min.js" integrity="sha256-rqEXy4JTnKZom8mLVQpvni3QHbynfjPmPxQVsPZgmJY=" crossorigin="anonymous"></script>
    <script src="./js/notyf.min.js"></script>
    <!-- Required Overall Script -->
<!-- <script src="./js/script.js"></script>
--><!-- Status Updater -->
<script src="./js/status.js"></script>
<!-- Sample Charts -->
<!-- <script src="./js/charts.js"></script> -->
<!-- Sample Notifications -->
<!-- <script src="./js/notification.js"></script> -->

</main>
</body>
</html>